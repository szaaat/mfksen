<!DOCTYPE html>
<html lang="hu">
<head>
    <meta charset="UTF-8">
    <title>7B Balprojekt Szenzor Adatok</title>
    <style>
        :root {
            --primary-color: #2E7D32; /* Zöld szín a témához */
        }
        body {
            font-family: 'Segoe UI', Arial, sans-serif;
            margin: 0;
            padding: 20px;
            background-color: #f5f5f5;
        }
        .logo-container {
            display: flex;
            gap: 20px;
            margin-bottom: 20px;
        }
        .logo {
            height: 60px;
        }
        h1 {
            color: var(--primary-color);
            border-bottom: 3px solid var(--primary-color);
            padding-bottom: 10px;
        }
        .sensor-tabs {
            margin: 20px 0;
        }
        .tab-button {
            padding: 10px 20px;
            background: #ddd;
            border: none;
            cursor: pointer;
            margin-right: 5px;
        }
        .tab-button.active {
            background: var(--primary-color);
            color: white;
        }
        table {
            width: 100%;
            border-collapse: collapse;
            background: white;
            box-shadow: 0 1px 3px rgba(0,0,0,0.1);
        }
        th, td {
            padding: 12px;
            text-align: left;
            border-bottom: 1px solid #ddd;
        }
        th {
            background-color: var(--primary-color);
            color: white;
        }
        tr:hover {
            background-color: #f0f0f0;
        }
        .timestamp {
            min-width: 180px;
        }
        .number {
            text-align: right;
            font-family: monospace;
        }
    </style>
</head>
<body>
    <div class="logo-container">
        <!-- Cseréld le a logo1.png, logo2.png-t a saját logóidra -->
        <img src="emnl_logo.png" class="logo" alt="Laboratórium logó">
        <img src="ME_MFK_logo.png" class="logo" alt="MFK logó">
    </div>

    <h1>Éghajlatváltozás Multidiszciplináris Nemzeti Laboratórium<br>7B Balprojekt Szenzor Adatok</h1>

    <div class="sensor-tabs">
        <button class="tab-button active" onclick="showTab('sensor1')">Szenzor #1</button>
        <!-- További gombok jönnek majd új szenzorok esetén -->
    </div>

    <div id="sensor1" class="tab-content">
        <table id="data-table">
            <thead>
                <tr>
                    <th class="timestamp">Időbélyeg</th>
                    <th>PM1</th>
                    <th>PM2.5</th>
                    <th>PM4</th>
                    <th>PM10</th>
                    <th>Páratart.</th>
                    <th>Hőmérs.</th>
                    <th>VOC</th>
                    <th>NOx</th>
                    <th>CO₂</th>
                </tr>
            </thead>
            <tbody></tbody>
        </table>
    </div>

    <script>
        const SHEET_URL = "https://docs.google.com/spreadsheets/d/e/2PACX-1vR8PPhpLDrZaQSjFH8y9_c1GU6mEPjpy1IBFy5FkCyFi2-XNYpHYJLDkibO8UFu4vDw_VwQVv8pnJcV/pub?gid=0&single=true&output=csv";

        async function fetchData() {
            try {
                const response = await fetch(`${SHEET_URL}?timestamp=${Date.now()}`);
                const csv = await response.text();
                const rows = csv.split('\n').slice(1); // Fejléc kihagyása
                
                const tbody = document.querySelector('#data-table tbody');
                tbody.innerHTML = rows.map(row => {
                    const cells = row.split('\t'); // Tabulátorral elválasztott adatok
                    return `
                        <tr>
                            <td class="timestamp">${cells[0]}</td>
                            ${cells.slice(1).map(cell => `
                                <td class="number">${parseFloat(cell.replace(',', '.')).toFixed(2)}</td>
                            `).join('')}
                        </tr>
                    `;
                }).join('');
            } catch (error) {
                console.error('Hiba történt:', error);
            }
        }

        // Tab-kezelés
        function showTab(sensorId) {
            document.querySelectorAll('.tab-content').forEach(tab => {
                tab.style.display = 'none';
            });
            document.querySelectorAll('.tab-button').forEach(btn => {
                btn.classList.remove('active');
            });
            document.getElementById(sensorId).style.display = 'block';
            event.currentTarget.classList.add('active');
        }

        // Automatikus frissítés 20 másodpercenként
        setInterval(fetchData, 20000);
        fetchData();
    </script>
</body>
</html>